Xcord = zeros(13,1); % to initialize array % Mu/(fckbD^2)
Ycord =  zeros (13,1); % Pu/(fckBD)
a = 2;
fy = 415;  % in N/mm^2, Grade of steel
fck = 25;        % in N/mm^2, Grade of conrete 
fsc=   327.7388; % in N/mm^2
rat = 0.1;       % d'/D = 0.1 %, Cover to total depth ratio
% p/fck is taken as P %
% P varies from 0.1 to 0.16 %
% value of is from 1 to 2%
P =  0;
for i=1:9
%---------------------------------------------------------------------------------
    % step 1
    Xcord(1) = 0;
    Ycord(1) = 0.446 + (P*(fsc - 0.446*fck)/100);
    
%--------------------------------------------------------------------------------------
    % step 2
    Xcord(2) = 0.02 + ((0.05*P*(0.67*fy - 0.4* fck))/100);
    Ycord(2) = 0.4 + ((P*(0.67*fy - 0.4*fck))/100);
    
%--------------------------------------------------------------------------------------------------
    %step 3
    k = 1.1;
    p1 = (P*fck)/2;
    p2 = (P*fck)/2;
    J1 = 0.4;    %y1/D = J
    J2 = -0.4; %y2/D = j1
    c1 = 0.384;
    c2 = 0.443;
    Es2 = 0.000636; %Es2 =Ec2
    Es1 = 0.003182; %Es1=Ec1
    fs1 = 355.4925; %interpolation
    fs2 = 119.4; %Es2*Es
    fc1 = 0.446*25; % 11.15
    fc2 = 0.446*25*(2*(Es2/0.002)-(Es2/0.002)*(Es2/0.002)); %5.6631
    Ycord(3)= 0.384 + (p1/(100*fck))*(fs1-fc1) + (p2/(100*fck))*(fs2-fc2);
    Xcord(3) = c1*(0.5-c2) + (p1/(100*fck))*(fs1-fc1)*(J1) + (p2/(100*fck))*(fs2-fc2)*(J2);
  
    %------------------------------------------------------------------------------------
    
    % step 4
 %--------------------------------------------------------------------------------------------
    % point 1
    k = 0.9;
    p1 = (P*fck)/2;
    p2 = (P*fck)/2;
    J1 = 0.4;
    J2 = -0.4;
    fs1 = 354.8625;
    fc1 = 11.15;
    fs2 = 0;
    fc2 =0;
    Es2 = 0;    
    Es1 = 0.00311;
    Xcord(4) =  0.36*k*(0.5 - 0.42*k) + (p1/(100*fck))*(fs1-fc1)*(J1) + (p2/(100*fck))*(fs2-fc2)*(J2); 
    Ycord(4) = 0.36*k + (p1/(100*fck))*(fs1-fc1) + (p2/(100*fck))*(fs2-fc2);
    
 %-----------------------------------------------------------------------------------
 

 % point 2
    p1 = (P*fck)/2;
    p2 = p1;
    J1 = 0.4;
    J2 = -0.4;
    k = 0.746454;
    fs2 = -144.42; %4*0.87*415
    Es2 = -0.00072;
    Es1 = 0.00303;
    fs1 = 354.8625;
    fc2 = 0;
    fc1 = 11.15;
    Xcord(5) = 0.36*k*(0.5 - 0.42*k) + (p1/(100*fck))*(fs1-fc1)*(J1) + (p2/(100*fck))*(fs2-fc2)*(J2);
    Ycord(5) = 0.36*k + (p1/(100*fck))*(fs1-fc1) + (p2/(100*fck))*(fs2-fc2);
  
     %------------------------------------------------------------------------------------
     

     %------------------------------------------------------------
     % point 3
    p1 = (P*fck)/2;
    p2 =  p1;
    J1 =  0.4;
    J2 =  -0.4;
    k =   0.6357548;
    fs2 = -288.84; 
    Es2 = -0.00145478;
    Es1 = 0.00294947;
    fs1 = 353.4578625;
    fc2 = 0;
    fc1 = 11.15;
    Xcord(6) = 0.36*k*(0.5 - 0.42*k) + (p1/(100*fck))*(fs1-fc1)*(J1) + (p2/(100*fck))*(fs2-fc2)*(J2);
    Ycord(6) = 0.36*k + (p1/(100*fck))*(fs1-fc1) + (p2/(100*fck))*(fs2-fc2);
 %----------------------------------------------------------

  % point 4
    p1 = (P*fck)/2;
    p2 =  p1;
    J1 =  0.4;
    J2 =  -0.4;
    k =   0.5943396226;
    fs2 = -361.05; 
    Es2 = -0.00180;
    Es1 = 0.0029111;
    fs1 = 353.1221252; %Doubt
    fc2 = 0;
    fc1 = 11.15;
    Xcord(7) =  0.36*k*(0.5 - 0.42*k) + (p1/(100*fck))*(fs1-fc1)*(J1) + (p2/(100*fck))*(fs2-fc2)*(J2);
    Ycord(7) = 0.36*k + (p1/(100*fck))*(fs1-fc1) + (p2/(100*fck))*(fs2-fc2) ;
    fprintf('%0.4f %0.4f %0.4f\n',Xcord(7),Ycord(7),P*fck);
    %---------------------------------------------------------
   
 
    %------------------------------------------------------------------------
     % point 5
    p1 = (P*fck)/2;
    p2 =  p1;
    J1 =  0.4;
    J2 =  -0.4;
    k =   0.43151;
    fs2 = -361.05; 
    Es2 = -0.00380;
    Es1 = 0.0026889;
    fs1 = 349.9717;
    fc2 = 0;
    fc1 = 11.15;
    Xcord(8) = 0.36*k*(0.5 - 0.42*k) + (p1/(100*fck))*(fs1-fc1)*(J1) + (p2/(100*fck))*(fs2-fc2)*(J2);
    Ycord(8) = 0.36*k + (p1/(100*fck))*(fs1-fc1) + (p2/(100*fck))*(fs2-fc2);
    fprintf('%0.4f %0.4f %0.4f\n',Xcord(8),Ycord(8),P*fck);
    %-------------------------------------------------------------------
    
    
    
    %-----------------------------------------------------------------------------------------------------------
    
     % point next
    p1 = (P*fck)/2;
    p2 =  p1;
    J1 =  0.4;
    J2 =  -0.4;
    k =   0.3;
    fs2 = -361.05; 
    Es2 = -0.0070;
    Es1 = 0.0023333;
    fs1 = 339.8612;
    fc2 = 0;
    fc1 = 11.15;
    Xcord(9) = 0.36*k*(0.5 - 0.42*k) + (p1/(100*fck))*(fs1-fc1)*(J1) + (p2/(100*fck))*(fs2-fc2)*(J2);
    Ycord(9) = 0.36*k + (p1/(100*fck))*(fs1-fc1) + (p2/(100*fck))*(fs2-fc2);
   fprintf('%0.4f %0.4f %0.4f\n',Xcord(9),Ycord(9),P*fck);
    %--------------------------------------
  %{
      k = 0.295;
      p1 = (P*fck)/2;
      p2 =  p1;
      J1 =  0.4;
      J2 =  -0.4;
      fs2 = -361.05;
      fc2 = 0;
      fc1 = 11.5;
      Es2 = -0.007177966;
      Es1 = 0.00231356;
      fs1 = 340.3201;
      Xcord(10) = 0.36*k*(0.5 - 0.42*k) + (p1/(100*fck))*(fs1-fc1)*(J1) + (p2/(100*fck))*(fs2-fc2)*(J2);
      Ycord(10) = 0.36*k + (p1/(100*fck))*(fs1-fc1) + (p2/(100*fck))*(fs2-fc2);
      fprintf('%0.4f %0.4f %0.4f\n',Xcord(10),Ycord(10),P*fck);
   
   %----------------------------- 
    
    %point 6 before before 
    k =  0.29;
    p1 = (P*fck)/2;
    p2 = (P*fck)/2;
    J1 = 0.4;
    J2 = -0.4;
    Es2 = -0.007362;
    Es1 = 0.0022931;
    fs1 = 338.5057;
    fs2 = -361.05;
    fc1 = 11.5;
    fc2 = 0;
    Ycord(11) = 0.36*k + (p1/(100*fck))*(fs1 - fc1) + (p2/(100*fck))*(fs2 - fc2); 
    Xcord(11) = 0.36*k*(0.5-0.42*k) + (p1/(100*fck))*(fs1-fc1)*(J1) + (p2/(100*fck))*(fs2-fc2)*(J2);
    fprintf('%0.4f %0.4f %0.4f\n',Xcord(11),Ycord(11),P*fck);
     %------------------------------------------------------------------------------------
    
   %}  
     
    %-----------------------------------------------------------------------------------------------------------
    
    %point 6 before 
    k =  0.28;
    p1 = (P*fck)/2;
    p2 = (P*fck)/2;
    J1 = 0.4;
    J2 = -0.4;
    Es2 = -0.00775;
    Es1 = 0.00225;
    fs1 = 348.67755;
    fs2 = -361.05;
    fc1 = 11.5;
    fc2 = 0;
    Ycord(10) = 0.36*k + (p1/(100*fck))*(fs1 - fc1) + (p2/(100*fck))*(fs2 - fc2); 
    Xcord(10) = 0.36*k*(0.5-0.42*k) + (p1/(100*fck))*(fs1-fc1)*(J1) + (p2/(100*fck))*(fs2-fc2)*(J2);
    fprintf('%0.4f %0.4f %0.4f\n',Xcord(12),Ycord(12),P*fck);
    %------------------------------------------------------------------------------------
    
    %point 6
    % at distance 3kd/7 the value of strain is 0.0035 
    k =  0.25;
    p1 = (P*fck)/2;
    p2 = (P*fck)/2;
    J1 = 0.4;
    J2 = -0.4;
    Es2 = -0.0091;
    Es1 = 0.0021;
    fs1 = 331.4123;
    fs2 = -361.05;
    fc1 = 11.5;
    fc2 = 0;
    Ycord(11) = 0.36*k + (p1/(100*fck))*(fs1 - fc1) + (p2/(100*fck))*(fs2 - fc2); 
    Xcord(11) = 0.36*k*(0.5-0.42*k) + (p1/(100*fck))*(fs1-fc1)*(J1) + (p2/(100*fck))*(fs2-fc2)*(J2);
  fprintf('%0.4f %0.4f %0.4f\n',Xcord(13),Ycord(13),P*fck);
    %------------------------------------------------------------------------------------
      
     %point 7 
    k =  0.2;
    p1 = (P*fck)/2;
    p2 = (P*fck)/2;
    J1 = 0.4;
    J2 = -0.4;
    Es2 = -0.01225;
    Es1 = 0.00175;
    fs1 = 314.1897;
    fs2 = -361.05;
    fc1 = 10.9758;
    fc2 = 0;
    Ycord(12) = 0.36*k + (p1/(100*fck))*(fs1 - fc1) + (p2/(100*fck))*(fs2 - fc2); 
    Xcord(12) = 0.36*k*(0.5-0.42*k) + (p1/(100*fck))*(fs1-fc1)*(J1) + (p2/(100*fck))*(fs2-fc2)*(J2);
     %------------------------------------------------------------------------------------ 
    
    % step 5
    p1 = (P*fck)/2;
    p2 = (P*fck)/2;
    J1 = 0.4;
    J2 = 0.4;
    Xcord(13) = (p1/(100*fck))*(0.87*fy)*(J1) + (p2/(100*fck))*(0.87*fy)*(J2);
    Ycord(13) = 0;
    %------------------------------------
    
    %Plot
    %yy=smooth (Ycord);
    plot(Xcord, Ycord);
    grid on;
    s = ['p/fck = ' num2str(P,'(%0.2f)')];
    text(Xcord(4),Ycord(4),s);
    P = P + 0.02;
    hold on;
end
clear title;
title('PM Interaction Diagram');
ylabel('Pu/fckbD');
xlabel('Mu/fckb\itD^{2}');
hold off;
